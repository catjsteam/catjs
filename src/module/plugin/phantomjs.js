var _catglobal=catrequire("cat.global"),_log=_catglobal.log(),_path=require("path"),_props=catrequire("cat.props"),_basePlugin=catrequire("cat.plugin.base"),_utils=catrequire("cat.utils");module.exports=_basePlugin.ext(function(){var t,a,e,i,n,r=this,o={_phantomjs:function(a){if(!a)return void 0;var i,r=_catglobal.get("home"),o=e.data,s=a.phantomjs,l=a.thiz,p=r.working.path,u=_path.join(p,"phantom",o.file);i=o.host||o.address,i||(i=n.getAddress());try{s&&s.run.call(l,{file:u,host:i},function(){t.emit("job.done",{status:"done"})})}catch(c){_utils.error(_props.get("cat.error").format("[spawn]",c))}},getListeners:function(a){return r.isDisabled()?void 0:t.listeners(a)},init:function(s){var l=["[spawn plugin] spawn operation disabled, No valid configuration"];s||(_log.error(l[1]),r.setDisabled(!0)),t=s.emitter,a=s.global,e=s.data,i=s.internalConfig,n=i.externalConfig.project,r.dataInit(e),t?t.on("phantomjs",o._phantomjs):_log.warning("[Scrap plugin] No valid emitter, failed to assign listeners")},validate:function(){return{dependencies:["phantomjs"]}}};return o});