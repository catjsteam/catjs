var _catglobal=catrequire("cat.global"),_log=_catglobal.log(),_path=require("path"),_props=catrequire("cat.props"),_basePlugin=catrequire("cat.plugin.base"),_utils=catrequire("cat.utils"),_fs=require("fs.extra"),_regexputils=catrequire("cat.regexp.utils"),_typedas=require("typedas");module.exports=_basePlugin.ext(function(){var e,a,t,i,r,n=this;return{init:function(l){var s,c,o,u,p,_,g=["[libraries plugin] No valid configuration"];l||(_log.error(g[1]),n.setDisabled(!0)),e=l.emitter,a=l.global,t=l.data,i=l.internalConfig,r=i?i.getProject():void 0,n.dataInit(t),_=t.data,l&&_&&(o=_.files,s=_.pattern,u=_.replace,c=_.flags,p=_.applyto,p||(p=["content"]),o&&o.forEach(function(e){var a,t;_fs.existsSync(e)&&(a=_fs.readFileSync(e,"utf8"),_utils.contains(p,"content")&&a&&(a=_regexputils.replace(a,s,u,c)),_fs.renameSync(e,[e,".catreplace"].join("")),t=_path.basename(e),_utils.contains(p,"filename")&&(t=_path.basename(e),t=_regexputils.replace(t,s,u,c)),_fs.writeFileSync(_path.join(_path.dirname(e),t),a))})),e.emit("job.done",{status:"done"})},validate:function(){return{dependencies:["manager"]}}}});