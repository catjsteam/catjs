var _scrapEnum=require("./../ScrapEnum.js"),_log=catrequire("cat.global").log(),_props=catrequire("cat.props"),_utils=catrequire("cat.utils"),_regutils=catrequire("cat.regexp.utils");module.exports=function(){var r=_regutils.preparePattern(_scrapEnum.scrapEnum.open),n=function(n){return _regutils.getMatchedValue(n,[r,_scrapEnum.scrapEnum.name,"@","(.*)"].join(""))},e=function(n){return _regutils.getMatchedValue(n,[r,"(",_scrapEnum.scrapEnum.name,")"].join(""))};return{parse:function(r){var a,u,t,c,s,p,i=0,l=[-1,-1],o=[0,0],m={},g=[],E=[];if(_scrapEnum.getScrapEnum("scrapinfo",m),r)for(a=r.length;a>i;i++)t=r[i],0===i?(m.start.line=t.number,m.start.col=t.col):i===a-1&&(m.end.line=t.number,m.end.col=t.col),u=t&&t.line?t.line:void 0,u&&(-1===l[0]&&(l[0]=u.indexOf(_scrapEnum.scrapEnum.open)),l[1]=u.indexOf(_scrapEnum.scrapEnum.close),l[0]>-1&&-1===l[1]&&(s||(p=u.substring(l[0]),s=e(p),c=n(p),o[0]=t.number),E.push(u)),l[1]>-1&&(l[1]+=_scrapEnum.scrapEnum.close.length,E.push(u),s===_scrapEnum.scrapEnum.name&&(o[1]=t.number,g.push({attrs:{name:c},name:s,rows:E.splice(0),start:{line:o[0],col:l[0]},end:{line:o[1],col:l[1]},comment:m})),(l[0]<-1||o[0]>o[1])&&(E=[],_log.warning(_props.get("cat.scrap.validation.close").format("[scrap plugin]"))),o=[0,0],l=[-1,-1],s=void 0));return g.length>0?g:void 0}}}();