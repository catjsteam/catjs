var _log=catrequire("cat.global").log(),_path=require("path"),_props=catrequire("cat.props"),_basePlugin=catrequire("cat.plugin.base"),_utils=catrequire("cat.utils"),_emitter,_global,_data,_internalConfig,_project;module.exports=_basePlugin.ext(function(){var e=this,t={_webserver:function(e){if(!e)return void 0;var r=_data.data,a=e.webserver,i=e.thiz,n=_project.getTargetFolder(),o=r.path?_path.join(n,r.path):n,s=r.action,l=r.set;try{a&&("start"===s?a.start.call(i,{set:l,path:o,port:r.port||_project.getPort()},function(){_emitter.emit("job.done",{status:"done"})}):"stop"===s&&a.stop.call(i,function(){_emitter.emit("job.done",{status:"done"})}))}catch(_){_utils.error(_props.get("cat.error").format("[spawn]",_))}_emitter.removeListener("webserver",t._webserver)},getListeners:function(t){return e.isDisabled()?void 0:_emitter.listeners(t)},init:function(r){var a=["[spawn plugin] spawn operation disabled, No valid configuration"];r||(_log.error(a[1]),e.setDisabled(!0)),_emitter=r.emitter,_global=r.global,_data=r.data,_internalConfig=r.internalConfig,_project=_internalConfig.externalConfig.project,e.dataInit(_data),_emitter?_emitter.on("webserver",t._webserver):_log.warning("[Scrap plugin] No valid emitter, failed to assign listeners")},validate:function(){return{dependencies:["webserver"]}}};return t});