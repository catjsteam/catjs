var _log=catrequire("cat.global").log(),_path=require("path"),_props=catrequire("cat.props"),_basePlugin=catrequire("cat.plugin.base"),_utils=catrequire("cat.utils"),_emitter,_global,_data,_internalConfig,_project;module.exports=_basePlugin.ext(function(){var t=this,e={_runner:function(t){if(!t)return void 0;var r=_data.data,n=t.runner,a=t.thiz,i=_project.getRunner(),o=_project.getTargetFolder(),l=r.path?_path.join(o,r.path):o,s=r.action,u=r.set;try{n&&("start"===s?n.start.call(a,{set:u,path:l,port:r.port||_project.getPort(),runnerconfig:i},function(){_emitter.emit("job.done",{status:"done"})}):"stop"===s&&n.stop.call(a,function(){_emitter.emit("job.done",{status:"done"})}))}catch(_){_utils.error(_props.get("cat.error").format("[spawn]",_))}_emitter.removeListener("runner",e._runner)},getListeners:function(e){return t.isDisabled()?void 0:_emitter.listeners(e)},init:function(r){var n=["[spawn plugin] spawn operation disabled, No valid configuration"];r||(_log.error(n[1]),t.setDisabled(!0)),_emitter=r.emitter,_global=r.global,_data=r.data,_internalConfig=r.internalConfig,_project=_internalConfig.externalConfig.project,t.dataInit(_data),_emitter?_emitter.on("runner",e._runner):_log.warning("[Scrap plugin] No valid emitter, failed to assign listeners")},validate:function(){return{dependencies:["runner"]}}};return e});