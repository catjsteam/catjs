var _catglobal=catrequire("cat.global"),_log=_catglobal.log(),_path=require("path"),_props=catrequire("cat.props"),_basePlugin=catrequire("cat.plugin.base"),_utils=catrequire("cat.utils"),_fs=require("fs.extra"),_typedas=require("typedas"),_Scrap=catrequire("cat.common.scrap");module.exports=_basePlugin.ext(function(){var e,t,a,r,i,n=this;return{init:function(o){var s,c,u,l,g=["[libraries plugin] No valid configuration"],p=_catglobal.get("home").working.path,_=[];o||(_log.error(g[1]),n.setDisabled(!0)),e=o.emitter,t=o.global,a=o.data,r=o.internalConfig,i=r?r.getProject():void 0,n.dataInit(a),c=a.data,o&&c&&(s=_Scrap.getScraps(),s&&(s.forEach(function(e){e&&e.get("auto")&&_.push({name:e.get("name")})}),u=p?_path.join(i.getInfo("source"),"config/cat.json"):void 0,u&&_fs.existsSync(u)&&(l=_fs.readFileSync(u,"utf8"),l&&(l=JSON.parse(l),l.tests&&(l.tests=_)),l["run-mode"]="test-manager"),_fs.writeFileSync(u,JSON.stringify(l)))),e.emit("job.done",{status:"done"})},validate:function(){return{dependencies:["manager"]}}}});