var _catglobal=catrequire("cat.global"),_log=_catglobal.log(),_path=require("path"),_props=catrequire("cat.props"),_basePlugin=catrequire("cat.plugin.base"),_utils=catrequire("cat.utils"),_fs=require("fs.extra"),_typedas=require("typedas"),_Scrap=catrequire("cat.common.scrap");module.exports=_basePlugin.ext(function(){var e,t,a,r,i,n=this;return{init:function(s){var o,c,l,u,g=["[libraries plugin] No valid configuration"],p=_catglobal.get("home").working.path,_=[];s||(_log.error(g[1]),n.setDisabled(!0)),e=s.emitter,t=s.global,a=s.data,r=s.internalConfig,i=r?r.getProject():void 0,n.dataInit(a),c=a.data,s&&c&&(o=_Scrap.getScraps(),o&&(o.forEach(function(e){e&&e.get("auto")&&_.push({name:e.get("name")})}),l=p?_path.join(i.getInfo("source"),"config/cat.json"):void 0,l&&_fs.existsSync(l)&&(u=_fs.readFileSync(l,"utf8"),u&&(u=JSON.parse(u),u.scenarios.general.tests&&u.tests&&(u.scenarios.general.tests=_)),u["run-mode"]="tests"),_fs.writeFileSync(l,JSON.stringify(u)))),e.emit("job.done",{status:"done"})},validate:function(){return{dependencies:["manager"]}}}});