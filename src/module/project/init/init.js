var _catglobal=catrequire("cat.global"),_log=_catglobal.log(),_utils=catrequire("cat.utils"),_path=require("path"),_fs=require("fs.extra"),_jsutils=require("js.utils");module.exports=function(){var t=_catglobal.get("home").working.path,e=_path.resolve(_path.join(cathome,"src/module/project/init/projects"));return{create:function(a){function o(){return s?!0:(console.log(i),s="cat",!1)}function r(o,r,p){var c,s,i,l;o&&r&&(p=p||{},i=_path.resolve(_path.join(r,"catproject.json")),c=_fs.readFileSync(i,"utf8"),c=_jsutils.Template.template({content:c,data:p}),s=_path.join(t,"cat-project"),_fs.existsSync(s)||_fs.mkdirpSync(s),_fs.writeFileSync(_path.join(s,"catproject.json"),c),_fs.copyRecursive(_path.resolve(_path.join(e,"base")),s,function(e){e&&_utils.log("[CAT init project] probably the files already exists, skipping... "),l=_fs.existsSync(_path.join(r,"app")),l?_fs.copyRecursive(_path.resolve(_path.join(r,"app")),_path.resolve(_path.join(t,"app")),function(t){t&&_utils.log("[CAT init project] probably the files already exists, skipping... "),a&&a.callback&&a.callback.call()}):a&&a.callback&&a.callback.call()}))}var p,c,s="name"in a&&a.projectname?a.projectname:void 0,i="[CAT init project] No valid project name was found, generating a base project";o(),p=_path.resolve(_path.join(e,s)),_fs.existsSync(p)||o()||(p=_path.resolve(_path.join(e,s))),c={name:a.name,source:a.source,target:a.target,cattarget:"./",host:a.host,port:a.port,protocol:a.protocol,appserver:{host:a.host,port:a.port,protocol:a.protocol},appath:a.appath},r(s,p,c)}}}();