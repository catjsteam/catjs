var _catglobal=catrequire("cat.global"),_log=_catglobal.log(),_utils=catrequire("cat.utils"),_path=require("path"),_fs=require("fs.extra"),_jsutils=require("js.utils");module.exports=function(){var t=_catglobal.get("home").working.path,e=_path.resolve(_path.join(cathome,"src/module/project/init/projects"));return{create:function(o){function r(){return c?!0:(console.log(i),c="cat",!1)}function a(o,r,a){var p,s,c,i;o&&r&&(a=a||{},c=_path.resolve(_path.join(r,"catproject.json")),p=_fs.readFileSync(c,"utf8"),p=_jsutils.Template.template({content:p,data:a}),s=_path.join(t,"cat-project"),_fs.existsSync(s)||_fs.mkdirpSync(s),_fs.writeFileSync(_path.join(s,"catproject.json"),p),_fs.copyRecursive(_path.resolve(_path.join(e,"base")),s,function(e){e?_utils.log("[CAT init project] resources copy failed with errors: ",e):(i=_fs.existsSync(_path.join(r,"app")),i&&_fs.copyRecursive(_path.resolve(_path.join(r,"app")),_path.resolve(_path.join(t,"app")),function(t){t&&_utils.log("[CAT init project] resources copy failed with errors: ",t)}))}))}var p,s,c="name"in o&&o.projectname?o.projectname:void 0,i="[CAT init project] No valid project name was found, generating an base project";r(),p=_path.resolve(_path.join(e,c)),_fs.existsSync(p)||r()||(p=_path.resolve(_path.join(e,c))),s={name:o.name,source:o.source,target:o.target,host:o.host,port:o.port,protocol:o.protocol,appserver:{host:o.host,port:o.port,protocol:o.protocol},appath:o.appath},a(c,p,s)}}}();