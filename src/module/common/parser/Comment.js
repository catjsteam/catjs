var _lineReader=require("line-reader"),_fs=require("fs.extra");module.exports=function(){var e=this,n=[],i={},r=function(r){var t=["/*","<!--"],u=["*/","-->"],l=r.file,s=r.callback;i[l]={lineNumber:1,comment:[],comments:[],opened:0},_lineReader.eachLine(l,function(e){var n=i[l].lineNumber,r=e.indexOf(t[0]),s=e.indexOf(t[1]),m=e.indexOf(u[0]),o=e.indexOf(u[1]),c=0,f=i[l].comment,h=i[l].comments;(-1!==r||-1!==s)&&(i[l].opened=1,c=1,-1!==r&&f.push({line:e.substring(r),number:n,col:r}),-1!==s&&f.push({line:e.substring(s),number:n,col:s})),!i[l].opened||-1===m&&-1===o||(i[l].opened=0,f.length>1&&(-1!==m&&f.push({line:e.substring(0,m+u[0].length),number:n,col:m+u[0].length}),-1!==o&&f.push({line:e.substring(0,o+u[1].length),number:n,col:o+u[1].length})),h.push(f.slice(0)),i[l].comment=[]),i[l].opened&&(c?c=0:f.push({line:e,number:n,col:0})),i[l].lineNumber++}).then(function(){i[l].lineNumber--,n.push(i[l].comment),s.call(e,i[l].comments)})};return{parse:function(e){var n=e.file;n&&_fs.existsSync(n)&&r(e)},getComments:function(){return n}}}();